'use strict';class Board{constructor(a,b){this.tailleCase=100;this.nbColonne=this.nbLigne=4;this.posX=a/2-this.tailleCase*this.nbColonne/2;this.posY=b/2-this.tailleCase*this.nbLigne/2;this.errorSound=new Sound("snd/error.wav");this.winnerSound=new Sound("snd/winner.wav");this.grille=Array(this.nbLigne);for(a=0;a<this.nbColonne;a++)this.grille[a]=Array(this.nbColonne);this.joueur=1;this.listePions=[];this.resetGrille()}getposX(){return this.posX}getposY(){return this.posY}playSoundWinner(){return this.winnerSound}boardClic(a,
b){a=Math.floor((a-this.posX)/this.tailleCase);b=Math.floor((b-this.posY)/this.tailleCase);0<=b&&b<this.nbLigne&&0<=a&&a<this.nbColonne&&(0==this.grille[b][a]?(this.grille[b][a]=this.joueur,a=this.posX+this.tailleCase*a,b=this.posY+this.tailleCase*b,1==this.joueur?(b=new Sprite("img/croix.png",a,b),this.joueur=2):(b=new Sprite("img/rond.png",a,b),this.joueur=1),this.listePions.push(b)):this.errorSound.soundPlay())}boardDraw(){let a=this.tailleCase*this.nbColonne;Gctx.strokeStyle="#42c0f2";Gctx.lineWidth=
"3";Gctx.lineCap="round";Gctx.lineJoin="round";Gctx.beginPath();Gctx.moveTo(this.posX,this.posY);Gctx.lineTo(this.posX+a,this.posY);Gctx.lineTo(this.posX+a,this.posY+a);Gctx.lineTo(this.posX,this.posY+a);Gctx.lineTo(this.posX,this.posY);Gctx.moveTo(this.posX+this.tailleCase,this.posY);Gctx.lineTo(this.posX+this.tailleCase,this.posY+a);Gctx.moveTo(this.posX+2*this.tailleCase,this.posY);Gctx.lineTo(this.posX+2*this.tailleCase,this.posY+a);Gctx.moveTo(this.posX+3*this.tailleCase,this.posY);Gctx.lineTo(this.posX+
3*this.tailleCase,this.posY+a);Gctx.moveTo(this.posX,this.posY+this.tailleCase);Gctx.lineTo(this.posX+a,this.posY+this.tailleCase);Gctx.moveTo(this.posX,this.posY+2*this.tailleCase);Gctx.lineTo(this.posX+a,this.posY+2*this.tailleCase);Gctx.moveTo(this.posX,this.posY+3*this.tailleCase);Gctx.lineTo(this.posX+a,this.posY+3*this.tailleCase);Gctx.stroke();this.listePions.forEach(b=>{b.spriteDraw()});Gctx.fillStyle="#dfaa1a";Gctx.font="30px sans-serif";Gctx.fillText("The player ",(Gcanvas.width-GticTacToe.getposX()-
200)/2,55);Gctx.fillStyle="#ffffff";Gctx.fillText(this.joueur,(Gcanvas.width-GticTacToe.getposX()+105)/2,55);Gctx.fillStyle="#dfaa1a";Gctx.fillText(" must play",(Gcanvas.width-GticTacToe.getposX()+140)/2,55);Gctx.fillStyle="#dfaa1a"}boardIsFull(){for(let a=0;a<this.nbLigne;a++)for(let b=0;b<this.nbColonne;b++)if(0==this.grille[a][b])return!1;return!0}boardReset(){this.listePions=[];this.resetGrille();this.joueur=1}boardGetWinner(a,b){let c=0,d=0,e=0;a=Math.floor((a-this.posX)/this.tailleCase);b=Math.floor((b-
this.posY)/this.tailleCase);0<=b&&b<this.nbLigne&&0<=a&&a<this.nbColonne&&(c=this.checkline(b),d=this.checkColonne(a),e=this.checkDiagonal());return 0!=c?c:0!=d?d:0!=e?e:0}resetGrille(){for(let a=0;a<this.nbLigne;a++)for(let b=0;b<this.nbColonne;b++)this.grille[a][b]=0}checkline(a){let b=[];for(let c=0;c<this.nbColonne;c++)b[c]=this.grille[a][c];return this.getTheWinner(b)}checkColonne(a){let b=[];for(let c=0;c<this.nbLigne;c++)b[c]=this.grille[c][a];return this.getTheWinner(b)}checkDiagonal(){let a=
[];var b=[];for(var c=0;c<this.nbColonne;c++)b[c]=this.grille[c][c];b=this.getTheWinner(b);if(0==b){b=this.nbColonne-1;for(c=0;c<this.nbColonne;c++)a[c]=this.grille[c][b],b--;b=this.getTheWinner(a)}return b}getTheWinner(a){let b=0,c=0,d=0;for(let e=0;e<this.nbColonne;e++)1==a[e]&&b++,2==a[e]&&c++;b==this.nbColonne?d=1:c==this.nbColonne&&(d=2);return 1==d||2==d?d:0}};